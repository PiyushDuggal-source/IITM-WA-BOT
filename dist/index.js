"use strict";var B=Object.create;var p=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var L=(s,e)=>{for(var n in e)p(s,n,{get:e[n],enumerable:!0})},T=(s,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of R(e))!w.call(s,i)&&i!==n&&p(s,i,{get:()=>e[i],enumerable:!(t=D(e,i))||t.enumerable});return s};var y=(s,e,n)=>(n=s!=null?B($(s)):{},T(e||!s||!s.__esModule?p(n,"default",{value:s,enumerable:!0}):n,s)),G=s=>T(p({},"__esModule",{value:!0}),s);var P={};L(P,{BOT:()=>E,WA_BOT_ID:()=>O});module.exports=G(P);var c=require("whatsapp-web.js"),M=require("./actions/messageActions"),S=require("./controllers/main"),d=require("./actions/introduction"),o=require("./utils/reply/replies"),r=require("./actions/sendMessage"),k=y(require("dotenv")),v=require("./utils/Commands/instructions"),_=require("./assets/assets"),a=require("./utils/log"),f=require("./services/modals"),b=y(require("mongoose")),u=require("./actions/sendAndDeleteMsg"),C=require("./actions/pingEveryone");const W=require("qrcode-terminal"),U=require("express");k.config();const g=U(),h=String(process.env.dev)==="true",E=h?1:0,O=h?process.env.WA_BOT_ID_DEV:process.env.WA_BOT_ID,J=h?process.env.DEV_DB_URL:process.env.PROD_DB_URL;b.default.connect(J).then(()=>{console.log("connected to DB");const s=new c.Client({puppeteer:{headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]},authStrategy:new c.LocalAuth({dataPath:`${__dirname}/sessions`})});s.on("qr",e=>{W.generate(e,{small:!0}),console.log(e)}),s.on("ready",async()=>{(0,a.log)({msg:"Client Connected",type:"CONNECTED",error:!1}),s.sendMessage(process.env.WA_BOT_ID_DEV,`${process.env.BOT_NAME}: I am Connected BOSS`)}),s.on("message_create",async e=>{var I;const n=(0,M.checkMessage)(e),t=e.mentionedIds;(e.body[0]==="@"&&t.includes("919871453667@c.us")||e.body.toLowerCase().split(" ").includes(`@${process.env.BOT_NAME.toLocaleLowerCase()}`))&&n!=="NONE"&&e.body.split(" ").length===1&&(0,d.introduction)(s,n,e);const l=(await s.getChats())[E];n!=="NONE"&&v.COMMANDS_CMDS.includes(e.body.split(",")[0].toLocaleLowerCase())&&(0,d.sendCommands)(s,e,n),n=="ADMIN"&&["everyone"].includes(e.body)&&await(0,C.pingEveryone)(s,e),n!=="NONE"&&e.body[0]===process.env.BOT_PREFIX&&await(0,S.main)(s,e,n),n==="ADMIN"&&e.body==="load"&&(console.log(l.participants),(I=l.participants)==null||I.forEach(async N=>{f.UserModel.create({name:N.id.user,chatId:N.id._serialized})}),l.sendMessage("SUCCESSFULLY ADDED ALL THE STUDENTS IN THE DB, MASTER!"))}),s.on("group_join",async e=>{if(e.chatId===process.env.WA_BOT_ID&&(0,a.log)({msg:`${e.recipientIds[0]} Joined the Group`,type:"GROUP_JOIN",error:!1}),e.chatId===O){const n=await s.getNumberId(e.recipientIds[0]),t=await s.getContactById((n==null?void 0:n._serialized)||"");t.name?(0,u.sendAndDeleteMsg)(s,e,e.recipientIds[0],`${process.env.BOT_NAME}: *${t.name}* Thanks for joining the Group!
${o.USER_JOIN_GREETINGS.messages[(0,r.random)(o.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${o.GREETINGS.member[(0,r.random)(o.GREETINGS.memberMsgNumber)]} ${o.HEY_EMOJIES[(0,r.random)(o.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`):(0,u.sendAndDeleteMsg)(s,e,e.recipientIds[0],`${process.env.BOT_NAME}: ${o.GREETINGS.member[(0,r.random)(o.GREETINGS.memberMsgNumber)]}, Thanks for Joining the Group!
${o.USER_JOIN_GREETINGS.messages[(0,r.random)(o.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${o.GREETINGS.member[(0,r.random)(o.GREETINGS.memberMsgNumber)]} ${o.HEY_EMOJIES[(0,r.random)(o.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`)}}),s.on("group_leave",async e=>{e.chatId===process.env.WA_BOT_ID&&(0,a.log)({msg:`${e.recipientIds[0]} left the Group`,type:"GROUP_LEFT",error:!1});const t=c.MessageMedia.fromFilePath(`${__dirname}/../src/assets/images/grpJoinLeaveImgs/${_.grpLeaveStickers.images[(0,r.random)(_.grpLeaveStickers.numOfImgs)]}.png`);if(e.chatId===O){const m=(await s.getChats())[E];m.sendMessage(`${process.env.BOT_NAME}: somebody left`),m.sendMessage(t,{sendMediaAsSticker:!0})}await f.UserModel.findOneAndDelete({chatId:e.chatId})}),s.initialize()}).catch(s=>{(0,a.log)({msg:s,type:"ERROR",error:!0})});const A=Number(process.env.PORT)||3005;g.get("/",(s,e)=>{e.send("BOT")}),g.listen(A,()=>(0,a.log)({msg:`[SERVER] Server is running on port ${A}`,type:"INFO",error:!1})),g.all("*",(s,e)=>{e.status(404).send("<h1>Sorry, this page does not exist!</h1><br><a href='/'>Back to Home</a>")});0&&(module.exports={BOT,WA_BOT_ID});
//# sourceMappingURL=index.js.map
