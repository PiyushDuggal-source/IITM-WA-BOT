"use strict";var B=Object.create;var d=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var $=Object.getOwnPropertyNames;var R=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var G=(e,s)=>{for(var r in s)d(e,r,{get:s[r],enumerable:!0})},T=(e,s,r,p)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of $(s))!w.call(e,o)&&o!==r&&d(e,o,{get:()=>s[o],enumerable:!(p=D(s,o))||p.enumerable});return e};var L=(e,s,r)=>(r=e!=null?B(R(e)):{},T(s||!e||!e.__esModule?d(r,"default",{value:e,enumerable:!0}):r,e)),W=e=>T(d({},"__esModule",{value:!0}),e);var H={};G(H,{BOT:()=>m,WA_BOT_ID:()=>O});module.exports=W(H);var c=require("whatsapp-web.js"),y=require("./actions/messageActions"),M=require("./controllers/main"),l=require("./actions/introduction"),n=require("./utils/reply/replies"),i=require("./actions/sendMessage"),J=L(require("dotenv")),C=require("./utils/Commands/instructions"),v=require("./actions/sendClassNotification"),f=require("./assets/assets"),a=require("./utils/log"),u=require("./services/models"),E=require("./actions/sendAndDeleteMsg"),S=require("./actions/pingEveryone"),b=require("./utils/db/connect");const U=require("qrcode-terminal"),k=require("express");J.config();const h=k(),_=String(process.env.dev)==="true",m=_?1:0,O=_?process.env.WA_BOT_ID_DEV:process.env.WA_BOT_ID,P=_?process.env.DEV_DB_URL:process.env.PROD_DB_URL;(async()=>await(0,b.connectToDb)(P))();const t=new c.Client({puppeteer:{headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]},authStrategy:new c.LocalAuth({dataPath:`${__dirname}/sessions`})});t.on("qr",e=>{U.generate(e,{small:!0}),console.log(e)}),t.on("ready",async()=>{(0,a.log)({msg:"Client Connected",type:"CONNECTED",error:!1}),t.sendMessage(process.env.WA_BOT_ID_DEV,`${process.env.BOT_NAME}: I am Connected BOSS`)}),t.on("message_create",async e=>{var I;const s=(0,y.checkMessage)(e),r=e.mentionedIds;(e.body[0]==="@"&&r.includes("919871453667@c.us")||e.body.toLowerCase().split(" ").includes(`@${process.env.BOT_NAME.toLocaleLowerCase()}`))&&s!=="NONE"&&e.body.split(" ").length===1&&(0,l.introduction)(t,s,e);const g=(await t.getChats())[m];s!=="NONE"&&C.COMMANDS_CMDS.includes(e.body.split(",")[0].toLocaleLowerCase())&&(0,l.sendCommands)(t,e,s),s=="ADMIN"&&["everyone"].includes(e.body)&&await(0,S.pingEveryone)(t,e),s!=="NONE"&&e.body[0]===process.env.BOT_PREFIX&&await(0,M.main)(t,e,s),s==="ADMIN"&&e.body==="load"&&(console.log(g.participants),(I=g.participants)==null||I.forEach(async N=>{u.UserModel.create({name:N.id.user,chatId:N.id._serialized})}),g.sendMessage("SUCCESSFULLY ADDED ALL THE STUDENTS IN THE DB, MASTER!"))}),t.on("group_join",async e=>{if(e.chatId===process.env.WA_BOT_ID&&(0,a.log)({msg:`${e.recipientIds[0]} Joined the Group`,type:"GROUP_JOIN",error:!1}),e.chatId===O){const s=await t.getNumberId(e.recipientIds[0]),r=await t.getContactById((s==null?void 0:s._serialized)||"");r.name?(0,E.sendAndDeleteMsg)(t,e,e.recipientIds[0],`${process.env.BOT_NAME}: *${r.name}* Thanks for joining the Group!
${n.USER_JOIN_GREETINGS.messages[(0,i.random)(n.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${n.GREETINGS.member[(0,i.random)(n.GREETINGS.memberMsgNumber)]} ${n.HEY_EMOJIES[(0,i.random)(n.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`):(0,E.sendAndDeleteMsg)(t,e,e.recipientIds[0],`${process.env.BOT_NAME}: ${n.GREETINGS.member[(0,i.random)(n.GREETINGS.memberMsgNumber)]}, Thanks for Joining the Group!
${n.USER_JOIN_GREETINGS.messages[(0,i.random)(n.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${n.GREETINGS.member[(0,i.random)(n.GREETINGS.memberMsgNumber)]} ${n.HEY_EMOJIES[(0,i.random)(n.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`)}}),t.on("group_leave",async e=>{e.chatId===process.env.WA_BOT_ID&&(0,a.log)({msg:`${e.recipientIds[0]} left the Group`,type:"GROUP_LEFT",error:!1});const r=c.MessageMedia.fromFilePath(`${__dirname}/../src/assets/images/grpJoinLeaveImgs/${f.grpLeaveStickers.images[(0,i.random)(f.grpLeaveStickers.numOfImgs)]}.png`);if(e.chatId===O){const o=(await t.getChats())[m];o.sendMessage(`${process.env.BOT_NAME}: somebody left`),o.sendMessage(r,{sendMediaAsSticker:!0})}await u.UserModel.findOneAndDelete({chatId:e.chatId})}),setInterval(async()=>{const s=(await t.getChats())[m];(0,v.sendClassNotification)(s),(0,a.log)({msg:"Checked",type:"INFO",error:!1})},5*60*1e3),t.initialize();const A=Number(process.env.PORT)||3005;h.get("/",(e,s)=>{s.send("BOT")}),h.listen(A,()=>(0,a.log)({msg:`[SERVER] Server is running on port ${A}`,type:"INFO",error:!1})),h.all("*",(e,s)=>{s.status(404).send("<h1>Sorry, this page does not exist!</h1><br><a href='/'>Back to Home</a>")});0&&(module.exports={BOT,WA_BOT_ID});
//# sourceMappingURL=index.js.map
