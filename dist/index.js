"use strict";var W=Object.create;var g=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var P=(e,r)=>{for(var s in r)g(e,s,{get:r[s],enumerable:!0})},y=(e,r,s,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of U(r))!k.call(e,i)&&i!==s&&g(e,i,{get:()=>r[i],enumerable:!(a=L(r,i))||a.enumerable});return e};var _=(e,r,s)=>(s=e!=null?W(J(e)):{},y(r||!e||!e.__esModule?g(s,"default",{value:e,enumerable:!0}):s,e)),F=e=>y(g({},"__esModule",{value:!0}),e);var x={};P(x,{BOT:()=>f,WA_BOT_ID:()=>u});module.exports=F(x);var d=require("whatsapp-web.js"),l=require("./actions/messageActions"),M=require("./controllers/main"),h=require("./actions/introduction"),t=require("./utils/reply/replies"),n=require("./actions/sendMessage"),v=_(require("express")),V=_(require("dotenv")),C=require("./utils/Commands/instructions"),O=require("./assets/assets"),b=require("./utils/log"),I=require("./actions/sendAndDeleteMsg"),S=require("./actions/pingEveryone"),c=require("./services/mongo"),R=require("./utils/db/connect"),B=require("./actions/removeMember"),w=require("./actions/sendClassNotification"),m=_(require("./utils/logger/index"));const H=require("qrcode-terminal");V.config();const E=(0,v.default)(),N=String(process.env.dev)==="true",f=N?1:0,u=N?process.env.WA_BOT_ID_DEV:process.env.WA_BOT_ID,q=N?process.env.DEV_DB_URL:process.env.PROD_DB_URL;(0,R.connectToDb)(q);const o=new d.Client({puppeteer:{headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]},authStrategy:new d.LocalAuth({dataPath:`${__dirname}/sessions`})});o.on("qr",e=>{H.generate(e,{small:!0}),console.log(e),m.default.info("QR generated",{label:"INFO"})}),o.on("ready",async()=>{m.default.info("Client Connected",{label:"CONNECTED"}),o.sendMessage(process.env.WA_BOT_ID_DEV,process.env.BOT_NAME+`: ${t.RANDOM_WAKEUP_MSG[(0,n.random)(t.RANDOM_WAKEUP_MSG.length)]}`)}),o.on("message_create",async e=>{var T;const r=await(0,l.checkMessage)(e),s=e.mentionedIds;(e.body[0]==="@"&&s.includes("919871453667@c.us")||e.body.toLowerCase().split(" ").includes(`@${process.env.BOT_NAME.toLocaleLowerCase()}`))&&r.role!=="NONE"&&e.body.split(" ").length===1&&(0,h.introduction)(o,r,e);let i=await o.getChats();const p=i[f],D=e.body.split(",")[0].toLocaleLowerCase();if(C.COMMANDS_CMDS.includes(D)){(0,h.sendCommands)(o,e,r),await(0,c.increaseNumberOfCmd)({recipitantId:r.chatId});return}if(r.role==="STUDENT"&&(0,l.superCmdFilter)(e.body)){p.sendMessage("You cannot perform this action, because you are not a BOT ADMIN, you will get ban if you use this frequently :)");return}if(r.role!=="NONE"&&(0,l.superCmdFilter)(e.body)){console.log("entering removing"),await(0,B.removeMember)(p,r,e);return}if(r.role==="OWNER"&&["everyone"].includes(e.body)){await(0,S.pingEveryone)(o,e);return}if(r.role!=="NONE"&&e.body[0]===process.env.BOT_PREFIX){await(0,M.main)(o,e,r);return}if(r.role==="OWNER"&&e.body==="load"){(T=p.participants)==null||T.forEach(async $=>{let G=$.id._serialized;await(0,c.addUser)({recipitantId:G})}),i[1].sendMessage("SUCCESSFULLY ADDED ALL THE STUDENTS IN THE DB, MASTER!");return}}),o.on("group_join",async e=>{if(e.chatId===u){(0,b.log)({msg:`${e.recipientIds[0]} Joined the Group`,type:"GROUP_JOIN",error:!1});const r=await o.getNumberId(e.recipientIds[0]),s=await o.getContactById((r==null?void 0:r._serialized)||"");s.name?(0,I.sendAndDeleteMsg)(o,e,e.recipientIds[0],`${process.env.BOT_NAME}: *${s.name}* Thanks for joining the Group!
${t.USER_JOIN_GREETINGS.messages[(0,n.random)(t.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${t.GREETINGS.member[(0,n.random)(t.GREETINGS.memberMsgNumber)]} ${t.HEY_EMOJIES[(0,n.random)(t.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`):(0,I.sendAndDeleteMsg)(o,e,e.recipientIds[0],`${process.env.BOT_NAME}: ${t.GREETINGS.member[(0,n.random)(t.GREETINGS.memberMsgNumber)]}, Thanks for Joining the Group!
${t.USER_JOIN_GREETINGS.messages[(0,n.random)(t.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${t.GREETINGS.member[(0,n.random)(t.GREETINGS.memberMsgNumber)]} ${t.HEY_EMOJIES[(0,n.random)(t.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`);const a=e.recipientIds[0];await(0,c.addUser)({recipitantId:a})}}),o.on("group_leave",async e=>{if(e.chatId===u&&(0,b.log)({msg:`${e.recipientIds[0]} left the Group`,type:"GROUP_LEFT",error:!1}),e.chatId===u&&e.type!=="remove"){const a=d.MessageMedia.fromFilePath(`${__dirname}/../src/assets/images/grpJoinLeaveImgs/${O.grpLeaveStickers.images[(0,n.random)(O.grpLeaveStickers.numOfImgs)]}.png`),p=(await o.getChats())[f];p.sendMessage(`${process.env.BOT_NAME}: somebody left`),p.sendMessage(a,{sendMediaAsSticker:!0})}const s=e.recipientIds[0];await(0,c.removeUser)({recipitantId:s})}),setInterval(async()=>{const r=(await o.getChats())[f];(0,w.sendClassNotification)(r),m.default.info("Checked",{label:"INFO"})},5*60*1e3),o.initialize();const A=Number(process.env.PORT)||3005;E.get("/",(e,r)=>{r.send("BOT")}),E.listen(A,()=>m.default.info(`[SERVER] Server is running on port ${A}`,{label:"INFO"})),E.all("*",(e,r)=>{r.status(404).send("<h1>Sorry, this page does not exist!</h1><br><a href='/'>Back to Home</a>")});0&&(module.exports={BOT,WA_BOT_ID});
//# sourceMappingURL=index.js.map
