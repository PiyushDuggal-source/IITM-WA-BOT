"use strict";var W=Object.create;var g=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var k=(e,r)=>{for(var o in r)g(e,o,{get:r[o],enumerable:!0})},I=(e,r,o,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of L(r))!J.call(e,n)&&n!==o&&g(e,n,{get:()=>r[n],enumerable:!(a=G(r,n))||a.enumerable});return e};var T=(e,r,o)=>(o=e!=null?W(U(e)):{},I(r||!e||!e.__esModule?g(o,"default",{value:e,enumerable:!0}):o,e)),P=e=>I(g({},"__esModule",{value:!0}),e);var q={};k(q,{BOT:()=>f,WA_BOT_ID:()=>u});module.exports=P(q);var d=require("whatsapp-web.js"),l=require("./actions/messageActions"),A=require("./controllers/main"),h=require("./actions/introduction"),s=require("./utils/reply/replies"),i=require("./actions/sendMessage"),M=T(require("express")),V=T(require("dotenv")),v=require("./utils/Commands/instructions"),E=require("./assets/assets"),m=require("./utils/log"),O=require("./actions/sendAndDeleteMsg"),C=require("./actions/pingEveryone"),p=require("./services/mongo"),S=require("./utils/db/connect"),B=require("./actions/removeMember"),w=require("./actions/sendClassNotification");const H=require("qrcode-terminal");V.config();const _=(0,M.default)(),N=String(process.env.dev)==="true",f=N?1:0,u=N?process.env.WA_BOT_ID_DEV:process.env.WA_BOT_ID,F=N?process.env.DEV_DB_URL:process.env.PROD_DB_URL;(0,S.connectToDb)(F);const t=new d.Client({puppeteer:{headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]},authStrategy:new d.LocalAuth({dataPath:`${__dirname}/sessions`})});t.on("qr",e=>{H.generate(e,{small:!0}),console.log(e)}),t.on("ready",async()=>{(0,m.log)({msg:"Client Connected",type:"CONNECTED",error:!1}),t.sendMessage(process.env.WA_BOT_ID_DEV,`${process.env.BOT_NAME}: I am Connected BOSS`)}),t.on("message_create",async e=>{var y;const r=await(0,l.checkMessage)(e),o=e.mentionedIds;(e.body[0]==="@"&&o.includes("919871453667@c.us")||e.body.toLowerCase().split(" ").includes(`@${process.env.BOT_NAME.toLocaleLowerCase()}`))&&r.role!=="NONE"&&e.body.split(" ").length===1&&(0,h.introduction)(t,r,e);let n=await t.getChats();const c=n[f],R=e.body.split(",")[0].toLocaleLowerCase();if(v.COMMANDS_CMDS.includes(R)){(0,h.sendCommands)(t,e,r),await(0,p.increaseNumberOfCmd)({recipitantId:r.chatId});return}if(r.role==="STUDENT"&&(0,l.superCmdFilter)(e.body)){c.sendMessage("You cannot perform this action, because you are not a BOT ADMIN, you will get ban if you use this frequently :)");return}if(r.role!=="NONE"&&(0,l.superCmdFilter)(e.body)){console.log("entering removing"),await(0,B.removeMember)(c,r,e);return}if(r.role==="OWNER"&&["everyone"].includes(e.body)){await(0,C.pingEveryone)(t,e);return}if(r.role!=="NONE"&&e.body[0]===process.env.BOT_PREFIX){await(0,A.main)(t,e,r);return}if(r.role==="OWNER"&&e.body==="load"){(y=c.participants)==null||y.forEach(async D=>{let $=D.id._serialized;await(0,p.addUser)({recipitantId:$})}),n[1].sendMessage("SUCCESSFULLY ADDED ALL THE STUDENTS IN THE DB, MASTER!");return}}),t.on("group_join",async e=>{if(e.chatId===u){(0,m.log)({msg:`${e.recipientIds[0]} Joined the Group`,type:"GROUP_JOIN",error:!1});const r=await t.getNumberId(e.recipientIds[0]),o=await t.getContactById((r==null?void 0:r._serialized)||"");o.name?(0,O.sendAndDeleteMsg)(t,e,e.recipientIds[0],`${process.env.BOT_NAME}: *${o.name}* Thanks for joining the Group!
${s.USER_JOIN_GREETINGS.messages[(0,i.random)(s.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${s.GREETINGS.member[(0,i.random)(s.GREETINGS.memberMsgNumber)]} ${s.HEY_EMOJIES[(0,i.random)(s.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`):(0,O.sendAndDeleteMsg)(t,e,e.recipientIds[0],`${process.env.BOT_NAME}: ${s.GREETINGS.member[(0,i.random)(s.GREETINGS.memberMsgNumber)]}, Thanks for Joining the Group!
${s.USER_JOIN_GREETINGS.messages[(0,i.random)(s.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${s.GREETINGS.member[(0,i.random)(s.GREETINGS.memberMsgNumber)]} ${s.HEY_EMOJIES[(0,i.random)(s.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`);const a=e.recipientIds[0];await(0,p.addUser)({recipitantId:a})}}),t.on("group_leave",async e=>{if(e.chatId===u&&(0,m.log)({msg:`${e.recipientIds[0]} left the Group`,type:"GROUP_LEFT",error:!1}),e.chatId===u&&e.type!=="remove"){const a=d.MessageMedia.fromFilePath(`${__dirname}/../src/assets/images/grpJoinLeaveImgs/${E.grpLeaveStickers.images[(0,i.random)(E.grpLeaveStickers.numOfImgs)]}.png`),c=(await t.getChats())[f];c.sendMessage(`${process.env.BOT_NAME}: somebody left`),c.sendMessage(a,{sendMediaAsSticker:!0})}const o=e.recipientIds[0];await(0,p.removeUser)({recipitantId:o})}),setInterval(async()=>{const r=(await t.getChats())[f];(0,w.sendClassNotification)(r),(0,m.log)({msg:"Checked",type:"INFO",error:!1})},5*60*1e3),t.initialize();const b=Number(process.env.PORT)||3005;_.get("/",(e,r)=>{r.send("BOT")}),_.listen(b,()=>(0,m.log)({msg:`[SERVER] Server is running on port ${b}`,type:"INFO",error:!1})),_.all("*",(e,r)=>{r.status(404).send("<h1>Sorry, this page does not exist!</h1><br><a href='/'>Back to Home</a>")});0&&(module.exports={BOT,WA_BOT_ID});
//# sourceMappingURL=index.js.map
