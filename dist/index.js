var D=Object.create;var m=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,L=Object.prototype.hasOwnProperty;var T=o=>m(o,"__esModule",{value:!0});var G=(o,e)=>{T(o);for(var s in e)m(o,s,{get:e[s],enumerable:!0})},U=(o,e,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of B(e))!L.call(o,n)&&n!=="default"&&m(o,n,{get:()=>e[n],enumerable:!(s=R(e,n))||s.enumerable});return o},r=o=>U(T(m(o!=null?D($(o)):{},"default",o&&o.__esModule&&"default"in o?{get:()=>o.default,enumerable:!0}:{value:o,enumerable:!0})),o);G(exports,{BOT:()=>f,WA_BOT_ID:()=>y});var i=r(require("whatsapp-web.js")),b=r(require("./actions/messageActions")),C=r(require("./controllers/main")),d=r(require("./actions/introduction")),t=r(require("./utils/reply/replies")),a=r(require("./actions/sendMessage")),J=r(require("dotenv")),v=r(require("./utils/Commands/instructions")),u=r(require("./assets/assets")),c=r(require("./utils/log")),A=r(require("./services/modals")),h=r(require("mongoose")),_=r(require("./actions/sendAndDeleteMsg")),I=r(require("./actions/pingEveryone"));const W=require("qrcode-terminal"),k=require("express"),{MongoStore:P}=require("wwebjs-mongo");J.config();const E=k(),l=String(process.env.dev)==="true",f=l?1:0,y=l?process.env.WA_BOT_ID_DEV:process.env.WA_BOT_ID,x=l?process.env.DEV_DB_URL:process.env.PROD_DB_URL;h.default.connect(x).then(()=>{console.log("connected to DB");const o=new P({mongoose:h.default});let e;l?e=new i.Client({puppeteer:{headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]},authStrategy:new i.LocalAuth({dataPath:`${__dirname}/sessions`})}):e=new i.Client({puppeteer:{headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]},authStrategy:new i.RemoteAuth({store:o,backupSyncIntervalMs:3e5})}),e.on("remote_session_saved",()=>{(0,c.log)({msg:"Remote auth session saved",type:"INFO",error:!1})}),e.on("disconnected",()=>{(0,c.log)({msg:"Client DISCONNECTED",type:"DISCONNECTED",error:!1})}),e.on("qr",s=>{W.generate(s,{small:!0}),console.log(s)}),e.on("ready",async()=>{(0,c.log)({msg:"Client Connected",type:"CONNECTED",error:!1}),e.sendMessage(process.env.WA_BOT_ID_DEV,`${process.env.BOT_NAME}: I am Connected BOSS`)}),e.on("message_create",async s=>{var M;const n=(0,b.checkMessage)(s),p=s.mentionedIds;(s.body[0]==="@"&&p.includes("919871453667@c.us")||s.body.toLowerCase().split(" ").includes(`@${process.env.BOT_NAME.toLocaleLowerCase()}`))&&n!=="NONE"&&s.body.split(" ").length===1&&(0,d.introduction)(e,n,s);let N=await e.getChats();const O=N[f];N=[],n!=="NONE"&&v.COMMANDS_CMDS.includes(s.body.split(",")[0].toLocaleLowerCase())&&(0,d.sendCommands)(e,s,n),n=="ADMIN"&&["everyone"].includes(s.body)&&await(0,I.pingEveryone)(e,s),n!=="NONE"&&s.body[0]===process.env.BOT_PREFIX&&await(0,C.main)(e,s,n),n==="ADMIN"&&s.body==="load"&&((M=O.participants)==null||M.forEach(async S=>{await A.UserModel.create({name:S.id.user,chatId:S.id._serialized})}),O.sendMessage("ADDED ALL THE STUDENTS TO THE DB SUCCESSFULLY MASTER!"))}),e.on("group_join",async s=>{if((0,c.log)({msg:`${s.recipientIds[0]} Joined the Group`,type:"GROUP_JOIN",error:!1}),s.chatId===y){const n=await e.getNumberId(s.recipientIds[0]),p=await e.getContactById((n==null?void 0:n._serialized)||"");p.name?(0,_.sendAndDeleteMsg)(e,s,s.recipientIds[0],`${process.env.BOT_NAME}: *${p.name}* Thanks for joining the Group!
${t.USER_JOIN_GREETINGS.messages[(0,a.random)(t.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${t.GREETINGS.member[(0,a.random)(t.GREETINGS.memberMsgNumber)]} ${t.HEY_EMOJIES[(0,a.random)(t.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`):(0,_.sendAndDeleteMsg)(e,s,s.recipientIds[0],`${process.env.BOT_NAME}: ${t.GREETINGS.member[(0,a.random)(t.GREETINGS.memberMsgNumber)]}, Thanks for Joining the Group!
${t.USER_JOIN_GREETINGS.messages[(0,a.random)(t.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${t.GREETINGS.member[(0,a.random)(t.GREETINGS.memberMsgNumber)]} ${t.HEY_EMOJIES[(0,a.random)(t.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`)}}),e.on("group_leave",async s=>{(0,c.log)({msg:`${s.recipientIds[0]} left the Group`,type:"GROUP_LEFT",error:!1});const n=i.MessageMedia.fromFilePath(`${__dirname}/../src/assets/images/grpJoinLeaveImgs/${u.grpLeaveStickers.images[(0,a.random)(u.grpLeaveStickers.numOfImgs)]}.png`);if(s.chatId===y){const g=(await e.getChats())[f];g.sendMessage(`${process.env.BOT_NAME}:`),g.sendMessage(n,{sendMediaAsSticker:!0})}}),e.initialize()}).catch(o=>{(0,c.log)({msg:o,type:"ERROR",error:!0})});const w=Number(process.env.PORT)||3005;E.get("/",(o,e)=>{e.send("BOT")}),E.listen(w,()=>(0,c.log)({msg:`[SERVER] Server is running on port ${w}`,type:"INFO",error:!1})),E.all("*",(o,e)=>{e.status(404).send("<h1>Sorry, this page does not exist!</h1><br><a href='/'>Back to Home</a>")});0&&(module.exports={BOT,WA_BOT_ID});
//# sourceMappingURL=index.js.map
