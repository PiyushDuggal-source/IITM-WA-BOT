"use strict";var G=Object.create;var g=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var k=(e,r)=>{for(var o in r)g(e,o,{get:r[o],enumerable:!0})},T=(e,r,o,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of L(r))!J.call(e,i)&&i!==o&&g(e,i,{get:()=>r[i],enumerable:!(a=W(r,i))||a.enumerable});return e};var I=(e,r,o)=>(o=e!=null?G(U(e)):{},T(r||!e||!e.__esModule?g(o,"default",{value:e,enumerable:!0}):o,e)),P=e=>T(g({},"__esModule",{value:!0}),e);var q={};k(q,{BOT:()=>u,WA_BOT_ID:()=>f});module.exports=P(q);var m=require("whatsapp-web.js"),l=require("./actions/messageActions"),A=require("./controllers/main"),h=require("./actions/introduction"),t=require("./utils/reply/replies"),n=require("./actions/sendMessage"),M=I(require("express")),V=I(require("dotenv")),v=require("./utils/Commands/instructions"),N=require("./assets/assets"),d=require("./utils/log"),O=require("./actions/sendAndDeleteMsg"),C=require("./actions/pingEveryone"),p=require("./services/mongo"),S=require("./utils/db/connect"),B=require("./actions/removeMember"),R=require("./actions/sendClassNotification");const H=require("qrcode-terminal");V.config();const _=(0,M.default)(),E=String(process.env.dev)==="true",u=E?1:0,f=E?process.env.WA_BOT_ID_DEV:process.env.WA_BOT_ID,F=E?process.env.DEV_DB_URL:process.env.PROD_DB_URL;(0,S.connectToDb)(F);const s=new m.Client({puppeteer:{headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]},authStrategy:new m.LocalAuth({dataPath:`${__dirname}/sessions`})});s.on("qr",e=>{H.generate(e,{small:!0}),console.log(e)}),s.on("ready",async()=>{(0,d.log)({msg:"Client Connected",type:"CONNECTED",error:!1}),s.sendMessage(process.env.WA_BOT_ID_DEV,process.env.BOT_NAME+`: ${t.RANDOM_WAKEUP_MSG[(0,n.random)(t.RANDOM_WAKEUP_MSG.length)]}`)}),s.on("message_create",async e=>{var y;const r=await(0,l.checkMessage)(e),o=e.mentionedIds;(e.body[0]==="@"&&o.includes("919871453667@c.us")||e.body.toLowerCase().split(" ").includes(`@${process.env.BOT_NAME.toLocaleLowerCase()}`))&&r.role!=="NONE"&&e.body.split(" ").length===1&&(0,h.introduction)(s,r,e);let i=await s.getChats();const c=i[u],w=e.body.split(",")[0].toLocaleLowerCase();if(v.COMMANDS_CMDS.includes(w)){(0,h.sendCommands)(s,e,r),await(0,p.increaseNumberOfCmd)({recipitantId:r.chatId});return}if(r.role==="STUDENT"&&(0,l.superCmdFilter)(e.body)){c.sendMessage("You cannot perform this action, because you are not a BOT ADMIN, you will get ban if you use this frequently :)");return}if(r.role!=="NONE"&&(0,l.superCmdFilter)(e.body)){console.log("entering removing"),await(0,B.removeMember)(c,r,e);return}if(r.role==="OWNER"&&["everyone"].includes(e.body)){await(0,C.pingEveryone)(s,e);return}if(r.role!=="NONE"&&e.body[0]===process.env.BOT_PREFIX){await(0,A.main)(s,e,r);return}if(r.role==="OWNER"&&e.body==="load"){(y=c.participants)==null||y.forEach(async D=>{let $=D.id._serialized;await(0,p.addUser)({recipitantId:$})}),i[1].sendMessage("SUCCESSFULLY ADDED ALL THE STUDENTS IN THE DB, MASTER!");return}}),s.on("group_join",async e=>{if(e.chatId===f){(0,d.log)({msg:`${e.recipientIds[0]} Joined the Group`,type:"GROUP_JOIN",error:!1});const r=await s.getNumberId(e.recipientIds[0]),o=await s.getContactById((r==null?void 0:r._serialized)||"");o.name?(0,O.sendAndDeleteMsg)(s,e,e.recipientIds[0],`${process.env.BOT_NAME}: *${o.name}* Thanks for joining the Group!
${t.USER_JOIN_GREETINGS.messages[(0,n.random)(t.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${t.GREETINGS.member[(0,n.random)(t.GREETINGS.memberMsgNumber)]} ${t.HEY_EMOJIES[(0,n.random)(t.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`):(0,O.sendAndDeleteMsg)(s,e,e.recipientIds[0],`${process.env.BOT_NAME}: ${t.GREETINGS.member[(0,n.random)(t.GREETINGS.memberMsgNumber)]}, Thanks for Joining the Group!
${t.USER_JOIN_GREETINGS.messages[(0,n.random)(t.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${t.GREETINGS.member[(0,n.random)(t.GREETINGS.memberMsgNumber)]} ${t.HEY_EMOJIES[(0,n.random)(t.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`);const a=e.recipientIds[0];await(0,p.addUser)({recipitantId:a})}}),s.on("group_leave",async e=>{if(e.chatId===f&&(0,d.log)({msg:`${e.recipientIds[0]} left the Group`,type:"GROUP_LEFT",error:!1}),e.chatId===f&&e.type!=="remove"){const a=m.MessageMedia.fromFilePath(`${__dirname}/../src/assets/images/grpJoinLeaveImgs/${N.grpLeaveStickers.images[(0,n.random)(N.grpLeaveStickers.numOfImgs)]}.png`),c=(await s.getChats())[u];c.sendMessage(`${process.env.BOT_NAME}: somebody left`),c.sendMessage(a,{sendMediaAsSticker:!0})}const o=e.recipientIds[0];await(0,p.removeUser)({recipitantId:o})}),setInterval(async()=>{const r=(await s.getChats())[u];(0,R.sendClassNotification)(r),(0,d.log)({msg:"Checked",type:"INFO",error:!1})},5*60*1e3),s.initialize();const b=Number(process.env.PORT)||3005;_.get("/",(e,r)=>{r.send("BOT")}),_.listen(b,()=>(0,d.log)({msg:`[SERVER] Server is running on port ${b}`,type:"INFO",error:!1})),_.all("*",(e,r)=>{r.status(404).send("<h1>Sorry, this page does not exist!</h1><br><a href='/'>Back to Home</a>")});0&&(module.exports={BOT,WA_BOT_ID});
//# sourceMappingURL=index.js.map
