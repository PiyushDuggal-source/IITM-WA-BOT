var R=Object.create;var g=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,L=Object.prototype.hasOwnProperty;var I=t=>g(t,"__esModule",{value:!0});var G=(t,s)=>{I(t);for(var e in s)g(t,e,{get:s[e],enumerable:!0})},W=(t,s,e)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of D(s))!L.call(t,o)&&o!=="default"&&g(t,o,{get:()=>s[o],enumerable:!(e=B(s,o))||e.enumerable});return t},r=t=>W(I(g(t!=null?R($(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);G(exports,{BOT:()=>N,WA_BOT_ID:()=>_});var i=r(require("whatsapp-web.js")),b=r(require("./actions/messageActions")),v=r(require("./controllers/main")),u=r(require("./actions/introduction")),n=r(require("./utils/reply/replies")),a=r(require("./actions/sendMessage")),J=r(require("dotenv")),C=r(require("./utils/Commands/instructions")),E=r(require("./assets/assets")),c=r(require("./utils/log")),f=r(require("mongoose")),y=r(require("./actions/sendAndDeleteMsg")),S=r(require("./actions/pingEveryone")),m=r(require("./services/mongo"));const U=require("qrcode-terminal"),k=require("express"),{MongoStore:P}=require("wwebjs-mongo");J.config();const O=k(),h=String(process.env.dev)==="true",N=h?1:0,_=h?process.env.WA_BOT_ID_DEV:process.env.WA_BOT_ID,x=h?process.env.DEV_DB_URL:process.env.PROD_DB_URL;f.default.connect(x).then(()=>{console.log("connected to DB");const t=new P({mongoose:f.default});let s;h?s=new i.Client({puppeteer:{headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]},authStrategy:new i.LocalAuth({dataPath:`${__dirname}/sessions`})}):s=new i.Client({puppeteer:{headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]},authStrategy:new i.RemoteAuth({store:t,backupSyncIntervalMs:3e5})}),s.on("remote_session_saved",()=>{(0,c.log)({msg:"Remote auth session saved",type:"INFO",error:!1})}),s.on("disconnected",()=>{(0,c.log)({msg:"Client DISCONNECTED",type:"DISCONNECTED",error:!1})}),s.on("qr",e=>{U.generate(e,{small:!0}),console.log(e)}),s.on("ready",async()=>{(0,c.log)({msg:"Client Connected",type:"CONNECTED",error:!1}),s.sendMessage(process.env.WA_BOT_ID_DEV,`${process.env.BOT_NAME}: I am Connected BOSS`)}),s.on("message_create",async e=>{const o=await(0,b.checkMessage)(e),p=e.mentionedIds;(e.body[0]==="@"&&p.includes("919871453667@c.us")||e.body.toLowerCase().split(" ").includes(`@${process.env.BOT_NAME.toLocaleLowerCase()}`))&&o!=="NONE"&&e.body.split(" ").length===1&&(0,u.introduction)(s,o,e);const d=(await s.getChats())[N];o!=="NONE"&&C.COMMANDS_CMDS.includes(e.body.split(",")[0].toLocaleLowerCase())&&(0,u.sendCommands)(s,e,o),o=="OWNER"&&["everyone"].includes(e.body)&&await(0,S.pingEveryone)(s,e),o!=="NONE"&&e.body[0]===process.env.BOT_PREFIX&&await(0,v.main)(s,e,o),o==="OWNER"&&e.body==="load"&&(console.log(d.participants),d.participants?.forEach(async A=>{let w=A.id._serialized;await(0,m.addUser)({recipitantId:w})}),d.sendMessage("SUCCESSFULLY ADDED ALL THE STUDENTS IN THE DB, MASTER!"))}),s.on("group_join",async e=>{if(e.chatId===process.env.WA_BOT_ID&&(0,c.log)({msg:`${e.recipientIds[0]} Joined the Group`,type:"GROUP_JOIN",error:!1}),e.chatId===_){const o=await s.getNumberId(e.recipientIds[0]),p=await s.getContactById(o?._serialized||"");p.name?(0,y.sendAndDeleteMsg)(s,e,e.recipientIds[0],`${process.env.BOT_NAME}: *${p.name}* Thanks for joining the Group!
${n.USER_JOIN_GREETINGS.messages[(0,a.random)(n.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${n.GREETINGS.member[(0,a.random)(n.GREETINGS.memberMsgNumber)]} ${n.HEY_EMOJIES[(0,a.random)(n.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`):(0,y.sendAndDeleteMsg)(s,e,e.recipientIds[0],`${process.env.BOT_NAME}: ${n.GREETINGS.member[(0,a.random)(n.GREETINGS.memberMsgNumber)]}, Thanks for Joining the Group!
${n.USER_JOIN_GREETINGS.messages[(0,a.random)(n.USER_JOIN_GREETINGS.messageNum)]}
Hey new ${n.GREETINGS.member[(0,a.random)(n.GREETINGS.memberMsgNumber)]} ${n.HEY_EMOJIES[(0,a.random)(n.HEY_EMOJIES.length)]}!
Check out what bot(${process.env.BOT_NAME}) can do by *Mentioning* me!
or check the Commands of ${process.env.BOT_NAME} by typing
*${process.env.BOT_PREFIX}AllCmds*
*IN THE GROUP*
Simply watch the Video: https://drive.google.com/file/d/1tl33VralV0AXQ2EDJYnjC6r2eaCUHr-l/view?usp=sharing`);const l=e.recipientIds[0];await(0,m.addUser)({recipitantId:l})}}),s.on("group_leave",async e=>{if(e.chatId===_&&(0,c.log)({msg:`${e.recipientIds[0]} left the Group`,type:"GROUP_LEFT",error:!1}),e.chatId===_){const l=i.MessageMedia.fromFilePath(`${__dirname}/../src/assets/images/grpJoinLeaveImgs/${E.grpLeaveStickers.images[(0,a.random)(E.grpLeaveStickers.numOfImgs)]}.png`),d=(await s.getChats())[N];d.sendMessage(`${process.env.BOT_NAME}: somebody left`),d.sendMessage(l,{sendMediaAsSticker:!0})}const p=e.recipientIds[0];await(0,m.removeUser)({recipitantId:p})}),s.initialize()}).catch(t=>{(0,c.log)({msg:t,type:"ERROR",error:!0})});const T=Number(process.env.PORT)||3005;O.get("/",(t,s)=>{s.send("BOT")}),O.listen(T,()=>(0,c.log)({msg:`[SERVER] Server is running on port ${T}`,type:"INFO",error:!1})),O.all("*",(t,s)=>{s.status(404).send("<h1>Sorry, this page does not exist!</h1><br><a href='/'>Back to Home</a>")});0&&(module.exports={BOT,WA_BOT_ID});
//# sourceMappingURL=index.js.map
